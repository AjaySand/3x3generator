<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>3x3</title>
    </head>
    <body>
        <canvas id="myCanvas" style="display: none;"></canvas>
        <div
            style="
                display: flex;
                justify-content: space-between;
                min-height: 25vh;
            "
        >
            <img
                style="
                    border: 1px solid black;
                    padding: 0.5em;
                    max-height: 400px;
                "
                name="img_1"
            />
            <img
                style="
                    border: 1px solid black;
                    padding: 0.5em;
                    max-height: 400px;
                "
                name="img_2"
            />
            <!-- <img style="border: 1px solid black; padding: 0.5em" name="img_3" /> -->
        </div>

        <div
            style="
                display: flex;
                justify-content: space-between;
            "
        >
            <input type="file" name="image1" id="image1" />
            <input type="file" name="image2" id="image2" />
        </div>

        <div style="display: flex; justify-content: center;">
            <button id="merge_image_btn">Merge images</button>
        </div>
        <div style="display: flex">
            <img
                style="
                    padding: 0.5em;
                    max-height: 400px;
                    border: 1px solid black;
                "
                id="merged_image"
            />
        </div>

        <script>
            let imgInput1 = document.getElementById("image1");
            let imgInput2 = document.getElementById("image2");

            let image1Url = "";
            let image2Url = "";

            imgInput1.onchange = function (e) {
                image1Url = URL.createObjectURL(e.target.files[0]);

                let img = document.getElementsByName("img_1")[0];
                img.src = image1Url;
                img.style.visibility = "visible";
            };

            imgInput2.onchange = function (e) {
                image2Url = URL.createObjectURL(e.target.files[0]);

                let img = document.getElementsByName("img_2")[0];
                img.src = image2Url;
                img.style.visibility = "visible";
            };

            function logImageUrls() {
                console.log({
                    image1Url: image1Url,
                    image2Url: image2Url,
                });
            }

            let mergeImageBtn = document.getElementById("merge_image_btn");
            let mergedImage = document.getElementById("merged_image");
            let myCanvas = document.getElementById("myCanvas");

            let imageObj1 = new Image();
            let imageObj2 = new Image();

            mergeImageBtn.onclick = function () {
                imageObj1.src = image1Url;
                imageObj2.src = image2Url;

                imageObj1.onload = function () {
                    imageObj2.onload = function () {
                        myCanvas.width = imageObj1.width + imageObj2.width;
                        if (imageObj2.height > imageObj1.height) {
                            myCanvas.height = imageObj2.height;
                        } else {
                            myCanvas.height = imageObj1.height;
                        }


                        let ctx = myCanvas.getContext('2d');
                        ctx.drawImage(imageObj1, 0, 0);
                        ctx.drawImage(imageObj2, imageObj1.width, 0);

                        mergedImage.src = myCanvas.toDataURL();
                        console.log(myCanvas.toDataURL());
                    }
                }
            };

            window.logImageUrls = logImageUrls;
        </script>
    </body>
</html>
